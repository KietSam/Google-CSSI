/*!CK:1115570133!*//*1433370271,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["i8O+e"]); }

__d("VideoWatchAndScrollContainer.react",["DOM","DOMContainer.react","DOMDimensions","Event","Parent","React","ReactCSSTransitionGroup","Rect","SubscriptionsHandler","cancelAnimationFrame","csx","cx","getViewportDimensions","requestAnimationFrame","shallowCompare","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();'use strict';var w=l,x=w.PropTypes,y=l.Component;for(var z in y)if(y.hasOwnProperty(z))ba[z]=y[z];var aa=y===null?null:y.prototype;ba.prototype=Object.create(aa);ba.prototype.constructor=ba;ba.__superConstructor__=y;function ba(ca,da){y.call(this,ca,da);this.state=this.$VideoWatchAndScrollContainer0(this.props);}ba.prototype.$VideoWatchAndScrollContainer0=function(ca){var da=this.$VideoWatchAndScrollContainer1(),ea=this.$VideoWatchAndScrollContainer2(this.props.initialPosition,da);return {containerBoundingBox:da,dragging:false,draggingMousePositionX:null,draggingMousePositionY:null,left:ea.left,top:ea.top};};ba.prototype.shouldComponentUpdate=function(ca,da){return u(this,ca,da);};ba.prototype.componentDidUpdate=function(ca,da){if(!da)return;if(!da.dragging&&this.state.dragging){this.documentSubscriptions=new o();this.documentSubscriptions.addSubscriptions(j.listen(document,'mousemove',this.$VideoWatchAndScrollContainer3.bind(this)),j.listen(document,'mouseup',this.$VideoWatchAndScrollContainer4.bind(this)));}else if(da.dragging&&!this.state.dragging)this.documentSubscriptions.release();};ba.prototype.componentDidMount=function(){this.resizeListener=j.listen(window,'resize',v(function(){var ca=this.$VideoWatchAndScrollContainer1(),da=this.$VideoWatchAndScrollContainer2({left:this.state.left,top:this.state.top},ca);this.setState({containerBoundingBox:ca,left:da.left,top:da.top});}.bind(this),100));};ba.prototype.componentWillUnmount=function(){this.props.onInitialPositionUpdate({left:this.state.left,top:this.state.top});if(this.documentSubscriptions)this.documentSubscriptions.release();if(this.resizeListener)this.resizeListener.remove();};ba.prototype.$VideoWatchAndScrollContainer5=function(event){if(event.button!==0)return;if(k.byClass(event.target,"_360f"))return;this.props.onGrab();this.setState({containerBoundingBox:this.$VideoWatchAndScrollContainer1(),dragging:true,draggingMousePositionX:event.screenX,draggingMousePositionY:event.screenY});event.preventDefault();};ba.prototype.$VideoWatchAndScrollContainer1=function(){var ca=0,da=g.scry(document.body,".fbChatSidebar");if(da.length===1)ca=i.getElementDimensions(da[0]).width;var ea=s.withoutScrollbars(),fa=new n(43,ea.width-ca,ea.height,0);return fa;};ba.prototype.$VideoWatchAndScrollContainer2=function(ca,da){var ea=new n(ca.top,ca.left+Math.round(this.props.width),ca.top+Math.round(this.props.height),ca.left);ea=ea.boundWithin(da);return {left:ea.getLeft(),top:ea.getTop()};};ba.prototype.$VideoWatchAndScrollContainer3=function(event){p(this.dragUpdateRequestAnimationFrameID);this.dragUpdateRequestAnimationFrameID=t(this.$VideoWatchAndScrollContainer6.bind(this,event));};ba.prototype.$VideoWatchAndScrollContainer6=function(event){if(!this.state.dragging)return;var ca=0;if(this.state.draggingMousePositionX!=null)ca=event.screenX-this.state.draggingMousePositionX;var da=0;if(this.state.draggingMousePositionY!=null)da=event.screenY-this.state.draggingMousePositionY;var ea=this.$VideoWatchAndScrollContainer2({left:this.state.left+ca,top:this.state.top+da},this.state.containerBoundingBox);this.setState({left:ea.left,top:ea.top,draggingMousePositionX:event.screenX,draggingMousePositionY:event.screenY});event.preventDefault();};ba.prototype.$VideoWatchAndScrollContainer4=function(event){p(this.dragUpdateRequestAnimationFrameID);this.props.onDrop();this.setState({dragging:false,draggingMousePositionX:null,draggingMousePositionY:null});event.preventDefault();};ba.prototype.render=function(){var ca={height:Math.round(this.props.height)+'px',left:this.state.left+'px',top:this.state.top+'px',width:Math.round(this.props.width)+'px'};return (l.createElement(m,{transitionAppear:true,transitionName:"fbWatchAndScroll-FadeIn"},l.createElement("div",{className:"_360g",onMouseDown:this.$VideoWatchAndScrollContainer5.bind(this),style:ca},l.createElement(h,null,this.props.videoElement))));};ba.propTypes={height:x.number.isRequired,initialPosition:x.object.isRequired,onDrop:x.func.isRequired,onGrab:x.func.isRequired,onInitialPositionUpdate:x.func.isRequired,videoElement:x.instanceOf(HTMLElement).isRequired,width:x.number.isRequired};e.exports=ba;},null);