/*!CK:94915502!*//*1437365731,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["G0Ma3"]); }

__d("PlacesCitySharerX",["Arbiter","ArbiterMixin","AsyncRequest","CSS","DOM","Event","Parent","csx","cx","fbt","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r={},s=q(h);for(var t in s)if(s.hasOwnProperty(t))v[t]=s[t];var u=s===null?null:s.prototype;v.prototype=Object.create(u);v.prototype.constructor=v;v.__superConstructor__=s;function v(w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){"use strict";s.call(this);this._root=w;this.setShareSetting(fa);this.init(x,y,z,aa,ba,ga,ia,ja);if(da)this.setDefaultCity(ca,da,ea);if(this._shareDefaultCity)this.useDefaultCity();if(ha)this.toggleSelect();}v.prototype.init=function(w,x,y,z,aa,ba,ca,da){"use strict";this._cityLink=w;this._closeButton=x;this._input=y;this._disableShareInput=z;this._options=aa;this._targetId=ba||0;this._cityName=k.find(this._cityLink,"._y8");this._data={};this._resetTempInfo();l.listen(this._closeButton,'click',function(){this._resetTempInfo();this._defaultCityData={};this.clearCity();this._disableShareInput.value='true';}.bind(this));r[this._root]=this;this.inform('init',null,g.BEHAVIOR_PERSISTENT);this._implicitLocationConfig=ca;this._checkinBranding=da;};v.prototype.toggleSelect=function(){"use strict";this._placeSelected=true;j.addClass(this._cityLink,"_1dsf");j.hide(this._closeButton);};v.prototype.addPlace=function(w){"use strict";this.toggleSelect();this._resetTempInfo();};v.prototype.changeCity=function(w,x,y){"use strict";this.setCity(w,x,y);this.toggleLocationSharing(w,x,y,false);};v.prototype.clearCity=function(){"use strict";this._data={};this._input.value='';k.empty(this._cityName);var w=this._checkinBranding?p._("Check in"):p._("Add a location to post");this._cityLink.setAttribute('aria-label',w);j.removeClass(this._root,"_y7");j.hide(this._closeButton);j.removeClass(this._cityLink,"_1dsf");this.inform('change',null,g.BEHAVIOR_PERSISTENT);};v.prototype.clearPlace=function(){"use strict";this._placeSelected=false;j.removeClass(this._cityLink,"_1dsf");j.conditionShow(this._closeButton,this.getValue());if(typeof this._implicitLocationConfig==='boolean'){if(this._implicitLocationConfig){this.clearCity();}else this.setDefaultCity(this._data.city_name,this._data.city_page_id,this._data.city_id);}else if(this._implicitLocationConfig.enable_implicit_location){this.setDefaultCity(this._data.city_name,this._data.city_page_id,this._data.city_id);}else this.clearCity();};v.prototype.getIcon=function(){"use strict";return this._root;};v.prototype.getValue=function(){"use strict";return this._input.value;};v.prototype.restoreCityInfo=function(){"use strict";if(this._placeSelected||this._shareDefaultCity){this.changeCity(this._tempCityName,this._tempCityPid,this._tempCityId);this._resetTempInfo();}};v.prototype.saveCityInfo=function(){"use strict";if(this._defaultCityData){this._tempCityName=this._defaultCityData.city_name;this._tempCityPid=this._defaultCityData.city_page_id;this._tempCityId=this._defaultCityData.city_id;}};v.prototype.setCity=function(w,x,y){"use strict";if(x){this.setCityData(w,x,y);this._input.value=x;this.inform('change',this._data,g.BEHAVIOR_PERSISTENT);}};v.prototype.setCityData=function(w,x,y){"use strict";if(x){this._data={city_name:w,city_page_id:x,city_id:y};var z=w.lastIndexOf(',');if(z!=-1)w=w.substring(0,z);var aa;if(w){aa=this._checkinBranding?p._("Currently in {city-name}. Check in",[p.param("city-name",w)]):p._("Currently in {city-name}. Add a location to post",[p.param("city-name",w)]);}else aa=this._checkinBranding?p._("Check in"):p._("Add a location to post");k.setContent(this._cityName,w);this._cityLink.setAttribute('aria-label',aa);j.addClass(this._root,"_y7");j.conditionShow(this._closeButton,!this._placeSelected);}};v.prototype.setDefaultCity=function(w,x,y){"use strict";this._defaultCityData={city_id:y,city_page_id:x,city_name:w};};v.prototype.setSessionID=function(w){"use strict";this._options.session_id=w;};v.prototype.setShareSetting=function(w){"use strict";this._shareDefaultCity=w;};v.prototype.toggleLocationSharing=function(w,x,y,z){"use strict";if(x)new i().setURI('/ajax/places/toggle_location_sharing').setData({city_id:y,city_page_id:x,city_name:w,is_default:z,session_id:this._options.session_id}).send();};v.prototype.useDefaultCity=function(){"use strict";if(this._defaultCityData){this.setCity(this._defaultCityData.city_name,this._defaultCityData.city_page_id,this._defaultCityData.city_id);j.show(this._closeButton);this.toggleLocationSharing(this._defaultCityData.city_name,this._defaultCityData.city_page_id,this._defaultCityData.city_id,true);}};v.prototype._resetTempInfo=function(){"use strict";this._tempCityName=null;this._tempCityPid=null;this._tempCityId=null;};v.getInstance=function(w){"use strict";var x=m.byClass(w,'ComposerCitySharer');return x&&r[x];};v.prototype.getTargetID=function(){"use strict";return this._targetId;};e.exports=v;},null);
__d("ComposerXCitySharerReset",["AsyncRequest"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(j){var k=j.instance.getTargetID();if(k!==0&&j.instance.getValue()!=="")k=0;j.instance.clearCity();new g().setURI('/ajax/places/city_sharer_reset.php').setData({target_id:k}).setHandler(function(l){i(j,l.getPayload());}).send();}function i(j,k){j.instance.setShareSetting(k.sharedefault);j.instance.setSessionID((new Date()).valueOf().toString().substr(0,10));if(k.citypageid)j.instance.setDefaultCity(k.citystring,k.citypageid,k.cityid);if(k.sharedefault)j.instance.useDefaultCity();}e.exports=h;},null);
__d("XPagesPresenceController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pages\/presence\/",{});},null);
__d("PagePresencePoller",["ActorURI","AsyncRequest","UserActivity","XPagesPresenceController"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=90000,l=0,m=function(o){l=Date.now();var p=g.create(j.getURIBuilder().getURI(),o);new h().setURI(p).send();},n={init:function(o){i.subscribe(function(){if(Date.now()-l>k)m(o);});setInterval(function(){if(i.isActive())m(o);},k);}};e.exports=n;},null);
__d("BasePrivacyWidget",["Arbiter","ArbiterMixin","DOM","Form","PrivacyConst"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=k.BaseValue;function m(){}Object.assign(m.prototype,h,{init:function(n,o,p,q){this._controllerId=o;this._root=n;this._options=Object.assign(q||{},p);this._formDataKey='privacy_data';},getData:function(){return this._model.getData();},_getPrivacyData:function(n){n=n||this._fbid;var o={};o[n]=this.getData();return o;},getRoot:function(){return this._root;},_initMenu:function(n){this._menu=n;this._menu.subscribe('itemclick',this._onMenuSelect.bind(this));},_isCustomSetting:function(n){return (n==l.CUSTOM);},_isEveryoneSetting:function(n){return (n==l.EVERYONE);},_updateSelector:function(n){var o=this._model.value;if(!this._isCustomSetting(o)){this._onPrivacyChanged();return;}},_onPrivacyChanged:function(){this._saveFormData();g.inform('Form/change',{node:this.getRoot()});this.inform('privacyChanged',this.getData());g.inform('UIPrivacyWidget/globalPrivacyChanged',{fbid:this._fbid,data:this.getData()});},_saveFormData:function(){var n=i.find(this.getRoot(),'div.UIPrivacyWidget_Form');i.empty(n);var o={};if(this._options.useLegacyFormData){o[this._formDataKey]=this.getData();}else o[this._formDataKey]=this._getPrivacyData();j.createHiddenInputs(o,n);}});e.exports=m;},null);
__d("TargetedPrivacyModel",["PrivacyConst","TargetedPrivacyConsts"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g.BaseValue;function j(){this.value=i.EVERYONE;this.countries=[];this.countries_names=[];this.location_type=h.LOC_ALL;this.location_ids=[];this.location_ids_names=[];this.locales=[];this.locales_names=[];this.gender=h.GENDER_BOTH;this.age_min=0;this.age_max=0;return this;}Object.assign(j.prototype,{init:function(k,l,m,n,o,p,q,r,s,t,u,v,w){this.value=k;this.countries=l.slice();this.countries_names=m.slice();this.location_type=n;this.location_ids=o.slice();this.location_ids_names=p.slice();this.age_min=q;this.age_max=r;this.gender=s;this.locales=t.slice();this.locales_names=u.slice();this.see_regions=w;this.see_cities=v;},getData:function(){var k={};if(this.value==i.EVERYONE)return k;var l=['countries','location_type','location_ids','age_min','age_max','gender','locales'];for(var m=0;m<l.length;++m){var n=l[m];k[n]=this[n];}k.genders=k.gender;return k;}});e.exports=j;},null);
__d("UITargetedPrivacyWidget",["ArbiterMixin","AsyncRequest","BasePrivacyWidget","BootloadedComponent.react","Dialog","DOM","JSResource","MenuSelectableItem","PrivacyConst","React","TargetedPrivacyConsts","TargetedPrivacyModel","Tooltip","$","classWithMixins","fbt","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();var x=u(i,w(g));for(var y in x)if(x.hasOwnProperty(y))aa[y]=x[y];var z=x===null?null:x.prototype;aa.prototype=Object.create(z);aa.prototype.constructor=aa;aa.__superConstructor__=x;function aa(ba,ca,da,ea,fa,ga,ha,ia){"use strict";x.call(this);var ja={useLegacyFormData:true};this.init(ca,da,ja,ia);this._profileId=ea;this._model=new r();this._formDataKey='targeted_privacy_data';this._button=fa;this._everyoneItem=this._retrieveEveryoneItem(ba);this._customItem=this._retrieveCustomItem(ba);this._defaultTooltip=ga;this._shouldDisplayTooltip=ha;aa.instances[this._controllerId]=this;this._initMenu(ba);this._saveFormData();}aa.prototype._onMenuSelect=function(ba,ca){"use strict";var da=ca.item;if(!da instanceof n)return;var ea=da.getValue();if(ea==o.BaseValue.EVERYONE)this._model=new r();this._saveFormData();this._updateSelector();this._updateTooltipForButtonFromItem(da);if(this._isCustomSetting(ea))this._showDialog();};aa.prototype._updateTooltipForButtonFromItem=function(ba){"use strict";if(!this._shouldDisplayTooltip)return;var ca=ba.getValue();if(this._isCustomSetting(ca)){s.set(this._button,v._("Custom"));}else s.set(this._button,this._defaultTooltip);};aa.prototype.reset=function(){"use strict";this._model=new r();this._updateSelector();this._saveFormData();return this;};aa.prototype.setProfileID=function(ba){"use strict";this._profileId=ba;};aa.prototype._showDialog=function(){"use strict";var ba={controller_id:this._controllerId,profile_id:this._profileId};if(this._options.useAdvancedGating){this._showAdvancedGatingDialog();}else this._dialog=new k().setAsync(new h().setURI(aa.DIALOG_URI).setData(ba)).setModal(true).show();};aa.prototype._showAdvancedGatingDialog=function(){"use strict";this._renderAdvancedGatingDialog(true);};aa.prototype._hideAdvancedGatingDialog=function(){"use strict";this._renderAdvancedGatingDialog(false);};aa.prototype._renderAdvancedGatingDialog=function(ba){"use strict";var ca=this._advancedGatingAnchor;if(!ca){this._advancedGatingAnchor=ca=l.create('span');l.appendContent(t(this._controllerId),ca);}p.render(p.createElement(j,{bootloadPlaceholder:p.createElement("span",null),bootloadLoader:m('PagePostAdvancedGatingDialog.react'),shown:ba,locations:{countries:this._model.countries},onCancel:this._hideAdvancedGatingDialog.bind(this),onSave:this._onAdvancedGatingSave.bind(this)}),ca);};aa.prototype._onAdvancedGatingSave=function(ba){"use strict";var ca=false;if(ba.countries.length>0)ca=true;if(ca){this._model.init(o.BaseValue.CUSTOM,ba.countries,[],q.LOC_ALL,[],[],0,0,q.GENDER_BOTH,[],[]);}else this.reset();this._onPrivacyChanged();this._hideAdvancedGatingDialog();};aa.prototype._updateSelector=function(ba){"use strict";z._updateSelector.call(this);if(ba&&!this._isCustomSetting(this._model.value)){this._everyoneItem.select();this._customItem.deselect();this._updateTooltipForButtonFromItem(this._everyoneItem);this._menu.inform('change',this._menu.getSelection());}};aa.prototype._retrieveEveryoneItem=function(ba){"use strict";return this._retrieveTargetItem(ba,this._isEveryoneSetting);};aa.prototype._retrieveCustomItem=function(ba){"use strict";return this._retrieveTargetItem(ba,this._isCustomSetting);};aa.prototype._retrieveTargetItem=function(ba,ca){"use strict";return ba._items.find(function(da){return (da instanceof n&&ca(da.getValue()));});};aa.getInstance=function(ba){"use strict";return this.instances[ba];};Object.assign(aa,{DIALOG_URI:'/ajax/privacy/targeted_privacy_widget_dialog.php',instances:{}});e.exports=aa;},null);