/*!CK:2361630961!*//*1436882232,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["feSJT"]); }

__d("ReactTransitionEvents",["ExecutionEnvironment"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';var h={transitionend:{transition:'transitionend',WebkitTransition:'webkitTransitionEnd',MozTransition:'mozTransitionEnd',OTransition:'oTransitionEnd',msTransition:'MSTransitionEnd'},animationend:{animation:'animationend',WebkitAnimation:'webkitAnimationEnd',MozAnimation:'mozAnimationEnd',OAnimation:'oAnimationEnd',msAnimation:'MSAnimationEnd'}},i=[];function j(){var n=document.createElement('div'),o=n.style;if(!('AnimationEvent' in window))delete h.animationend.animation;if(!('TransitionEvent' in window))delete h.transitionend.transition;for(var p in h){var q=h[p];for(var r in q)if(r in o){i.push(q[r]);break;}}}if(g.canUseDOM)j();function k(n,o,p){n.addEventListener(o,p,false);}function l(n,o,p){n.removeEventListener(o,p,false);}var m={addEndEventListener:function(n,o){if(i.length===0){window.setTimeout(o,0);return;}i.forEach(function(p){k(n,p,o);});},removeEndEventListener:function(n,o){if(i.length===0)return;i.forEach(function(p){l(n,p,o);});}};e.exports=m;},null);
__d("EntstreamStoryAttachment",["CSS","Event"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(j,k){"use strict";this.link=j;this.attachment=k;g.hide(this.attachment);h.listen(this.link,'click',this.showAttachment.bind(this));}i.prototype.showAttachment=function(){"use strict";g.hide(this.link);g.show(this.attachment);};e.exports=i;},null);
__d("AnimatedImageMarauderLogger",["MarauderLogger"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();function h(){"use strict";this.$AnimatedImageMarauderLogger0=false;this.$AnimatedImageMarauderLogger1=null;this.$AnimatedImageMarauderLogger2=null;this.$AnimatedImageMarauderLogger3=false;this.$AnimatedImageMarauderLogger4=false;this.$AnimatedImageMarauderLogger5=false;this.$AnimatedImageMarauderLogger6=null;this.$AnimatedImageMarauderLogger7=false;this.$AnimatedImageMarauderLogger8=null;this.$AnimatedImageMarauderLogger9=null;this.$AnimatedImageMarauderLoggera=0;this.$AnimatedImageMarauderLoggerb=false;}h.prototype.initSession=function(i,j,k,l,m,n){"use strict";this.$AnimatedImageMarauderLogger0=i;this.$AnimatedImageMarauderLoggerc=j;this.$AnimatedImageMarauderLogger5=l;this.$AnimatedImageMarauderLogger6=k;this.$AnimatedImageMarauderLogger7=m;this.$AnimatedImageMarauderLogger8=n;this.$AnimatedImageMarauderLogger3=true;};h.prototype.hasCurrentSession=function(){"use strict";return this.$AnimatedImageMarauderLogger3;};h.prototype.logAnimatedRender=function(i){"use strict";if(this.$AnimatedImageMarauderLogger9&&this.$AnimatedImageMarauderLoggera===0){this.$AnimatedImageMarauderLogger1=i-this.$AnimatedImageMarauderLogger9;this.$AnimatedImageMarauderLogger4=true;}};h.prototype.logStaticClick=function(i){"use strict";this.$AnimatedImageMarauderLogger9=i;this.$AnimatedImageMarauderLoggerb=true;};h.prototype.endSession=function(i){"use strict";if(this.$AnimatedImageMarauderLogger8)this.$AnimatedImageMarauderLoggera=i-this.$AnimatedImageMarauderLogger8;this.$AnimatedImageMarauderLogger3=false;this.logSession();};h.prototype.logSession=function(){"use strict";var i={autoplay:this.$AnimatedImageMarauderLogger0,download_time:this.$AnimatedImageMarauderLogger1,is_video:this.$AnimatedImageMarauderLogger5,image_src:this.$AnimatedImageMarauderLogger6,fbid:this.$AnimatedImageMarauderLoggerc,load_succeeded:this.$AnimatedImageMarauderLogger4,plays_inline:this.$AnimatedImageMarauderLogger7,time_spent:this.$AnimatedImageMarauderLoggera,was_tapped:this.$AnimatedImageMarauderLoggerb};g.log('animated_image_session',(void 0),i);};e.exports=h;},null);
__d("FeedAnimatedImageShare.react",["DOMContainer.react","OnVisible.react","Image.react","AnimatedImageMarauderLogger","React","ReactTransitionEvents","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=k,o=n.PropTypes,p=k.createClass({displayName:"FeedAnimatedImageShare",propTypes:{animatedSrc:o.string,autoplay:o.bool,fbid:o.string,height:o.number.isRequired,href:o.string.isRequired,isPlayableInline:o.bool,overlay:o.object,staticSrc:o.string,videoController:o.object,videoElement:o.object,width:o.number.isRequired},getDefaultProps:function(){return {autoplay:false,isPlayableInline:false};},getInitialState:function(){return {disableAutoplay:false,hasPlayedAtleastOnce:false,isLoaded:false,isLoading:false,isPlaying:false,wasPlaying:false};},componentDidMount:function(){this._animatedMarauderLogger=new j();if(this.refs.playButton)l.addEndEventListener(k.findDOMNode(this.refs.playButton),this.play);this._initVideoPlayer();},_initVideoPlayer:function(){if(!this.props.videoController||!this.refs.videoPlayer)return;k.findDOMNode(this.refs.videoPlayer).addEventListener('click',this._onClick);this.props.videoController.addListener('finishPlayback',function(){window.setTimeout(function(){this.props.videoController.play();}.bind(this),1);}.bind(this));},_shouldAutoplay:function(){return this.props.autoplay&&!this.state.disableAutoplay;},_showAnimatedImage:function(){if(this.state.isLoading)return;this.setState({isLoading:true});var q=new Image();q.onload=function(){this.setState({hasPlayedAtleastOnce:true,isLoaded:true,isLoading:false});this._animatedMarauderLogger.logAnimatedRender(Date.now());}.bind(this);q.src=this.props.animatedSrc;},_onClick:function(){this.setState({disableAutoplay:true});if(!this.props.isPlayableInline){window.open(this.props.href,'_blank');return;}if(this.state.isPlaying){this.pause();}else this.play();},_renderClickToPlayButton:function(){var q=this.props.isPlayableInline&&(!this.state.isPlaying||this.state.isLoading),r=this.state.isLoading,s=!this.state.hasPlayedAtleastOnce&&this.state.isLoaded;return (k.createElement("div",{className:((!q?"hidden_elem":'')),onClick:this._onClick},k.createElement("div",{ref:"playButton",className:(("_393-")+(s?' '+"_30a":''))}),k.createElement("div",{className:(("_30b")+(r?' '+"_30c":'')+(s?' '+"_30e":''))}),k.createElement("div",{className:(("_30h")+(s?' '+"_30i":''))})));},_initSession:function(){this._animatedMarauderLogger.initSession(this.props.autoplay,this.props.fbid,this.props.href,this.props.isPlayableInline,!!this.props.videoController,Date.now());},_endSession:function(){if(this._animatedMarauderLogger&&this._animatedMarauderLogger.hasCurrentSession())this._animatedMarauderLogger.endSession(Date.now());},_onVisible:function(){this._initSession();if(!this.state.isPlaying&&this.props.isPlayableInline&&(this._shouldAutoplay()||this.state.wasPlaying))this.play();},_onHidden:function(){this._endSession();this.setState({wasPlaying:this.state.isPlaying});if(this.state.isPlaying)this.pause();},_getStaticImageElement:function(){if(!this.props.staticSrc)return null;return (k.createElement(i,{className:"_9_m _30j",src:this.props.staticSrc,width:this.props.width,height:this.props.height,onClick:this._onClick}));},_getAnimatedImageElement:function(){return (k.createElement(i,{className:"_9_m",src:this.props.animatedSrc,width:this.props.width,height:this.props.height,onClick:this._onClick}));},_getImageElement:function(){if(!this.state.isPlaying||!this.state.isLoaded||!this.props.isPlayableInline)return this._getStaticImageElement();return this._getAnimatedImageElement();},_getVideoElement:function(){if(!this.props.videoElement)return null;return (k.createElement("span",null,k.createElement("span",{className:((!this.state.hasPlayedAtleastOnce?"hidden_elem":''))},k.createElement(g,{ref:"videoPlayer"},this.props.videoElement)),k.createElement("span",{className:((this.state.hasPlayedAtleastOnce?"hidden_elem":''))},this._getStaticImageElement())));},_getOverlay:function(){if(this.state.isPlaying||!this.props.overlay)return null;return k.createElement(g,null,this.props.overlay);},play:function(){this._animatedMarauderLogger.logStaticClick(Date.now());this.setState({isPlaying:true});if(this.props.videoController){if(!this.state.hasPlayedAtleastOnce)this.setState({hasPlayedAtleastOnce:true});this.props.videoController.play();}else this._showAnimatedImage();},pause:function(){this.setState({isPlaying:false});if(this.props.videoController)this.props.videoController.pause();},render:function(){return (k.createElement(h,{onVisible:this._onVisible,onHidden:this._onHidden},k.createElement("div",null,this._getVideoElement()||this._getImageElement(),this._renderClickToPlayButton(),this._getOverlay())));}});e.exports=p;},null);